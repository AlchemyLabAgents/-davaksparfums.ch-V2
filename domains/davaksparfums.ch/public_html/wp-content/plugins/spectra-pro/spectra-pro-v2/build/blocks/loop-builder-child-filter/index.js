(()=>{"use strict";const e=window.wp.blocks,t=JSON.parse('{"UU":"spectra-pro/loop-builder-child-filter"}'),o=window.wp.blockEditor,l=window.wp.components,a=window.wp.data,r=window.wp.coreData,n=window.wp.element,s=window.wp.htmlEntities,c=window.wp.i18n,i=window.ReactJSXRuntime,p=[{label:(0,c._x)("Select","Filter type option for Query Category block","spectra-pro"),value:"select"},{label:(0,c._x)("Checkbox","Filter type option for Query Category block","spectra-pro"),value:"checkbox"},{label:(0,c._x)("Button","Filter type option for Query Category block","spectra-pro"),value:"button"}],u=(e,t)=>e.length?e.filter((e=>!t.includes(e.value))).map((e=>e.label)):[],m=(0,n.memo)((e=>{const{setAttributes:t,attributes:{filterType:m,showPostCount:x,showEmptyTaxonomy:_,showChildren:d,filterMode:h,taxonomyType:g,tagTaxonomyInclude:C,tagTaxonomyExclude:b,catTaxonomyInclude:y,catTaxonomyExclude:w}}=e,v=(0,a.useSelect)((e=>{if(!["post_tag","category"].includes(g))return[];const t=e("core").getEntityRecords("taxonomy",g,{per_page:-1,_fields:["id","name","parent"],hide_empty:!_})||[];return(d?t:t.filter((e=>!e.parent))).map((e=>({label:e.name,value:e.id})))}),[g,d,_]),T=(0,a.useSelect)((e=>{const{getTaxonomies:t}=e(r.store),o=t();return o?o.filter((({visibility:e})=>!!e?.publicly_queryable)).map((e=>({label:(0,s.decodeEntities)(e.name),value:e.slug}))).filter(Boolean):[{label:(0,c.__)("No Taxonomies Found","spectra-pro"),value:""}]}),[]),f=(0,n.useMemo)((()=>u(v,y)),[v,y]),M=(0,n.useMemo)((()=>u(v,w)),[v,w]),E=(0,n.useMemo)((()=>u(v,C)),[v,C]),k=(0,n.useMemo)((()=>u(v,b)),[v,b]),B=e=>e.map((e=>{const t=v.find((t=>t.value===e));return t?t.label:e}));return(0,i.jsx)(o.InspectorControls,{group:"settings",children:(0,i.jsxs)(l.__experimentalToolsPanel,{label:(0,c.__)("General","spectra-pro"),resetAll:()=>{t({filterType:"select",showPostCount:!0,showEmptyTaxonomy:!1,showChildren:!1,filterMode:"include",taxonomyType:"category",tagTaxonomyInclude:[],tagTaxonomyExclude:[],catTaxonomyInclude:[],catTaxonomyExclude:[],placeholder:(0,c.__)("Select","spectra-pro")})},children:[(0,i.jsx)(l.__experimentalToolsPanelItem,{hasValue:()=>!!m&&"select"!==m,label:(0,c.__)("Filter Display Type","spectra-pro"),onDeselect:()=>t({filterType:"select"}),isShownByDefault:!0,children:(0,i.jsx)(l.__experimentalToggleGroupControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,c.__)("Filter Display Type","spectra-pro"),value:m,onChange:e=>{t({filterType:e})},help:"button"!==m&&(0,c.__)("Block Spacing will not affect this type","spectra-pro"),isBlock:!0,children:p.map((e=>(0,i.jsx)(l.__experimentalToggleGroupControlOption,{value:e.value,label:e.label},e.value)))})}),(0,i.jsx)(l.__experimentalToolsPanelItem,{hasValue:()=>!x,label:(0,c.__)("Post Counts","spectra-pro"),onDeselect:()=>t({showPostCount:!0}),isShownByDefault:!0,children:(0,i.jsx)(l.ToggleControl,{__nextHasNoMarginBottom:!0,label:(0,c.__)("Show Posts Count","spectra-pro"),help:(0,c.__)("Display the number of posts associated with each term.","spectra-pro"),onChange:e=>t({showPostCount:e}),checked:!0===x})}),(0,i.jsx)(l.__experimentalToolsPanelItem,{hasValue:()=>!_,label:(0,c.__)("Empty Terms","spectra-pro"),onDeselect:()=>t({showEmptyTaxonomy:!1}),isShownByDefault:!0,children:(0,i.jsx)(l.ToggleControl,{__nextHasNoMarginBottom:!0,label:(0,c.__)("Show Empty Terms","spectra-pro"),help:(0,c.__)("Include taxonomies even if they have no associated posts.","spectra-pro"),checked:!0===_,onChange:e=>t({showEmptyTaxonomy:e})})}),(0,i.jsx)(l.__experimentalToolsPanelItem,{hasValue:()=>!d,label:(0,c.__)("Child Terms","spectra-pro"),onDeselect:()=>t({showChildren:!0}),isShownByDefault:!0,children:(0,i.jsx)(l.ToggleControl,{__nextHasNoMarginBottom:!0,label:(0,c.__)("Show Child Terms","spectra-pro"),help:(0,c.__)("Display hierarchical relationships between terms.","spectra-pro"),onChange:e=>t({showChildren:e}),checked:!0===d})}),(0,i.jsx)(l.__experimentalToolsPanelItem,{hasValue:()=>!!g,label:(0,c.__)("Choose Taxonomy","spectra-pro"),onDeselect:()=>t({taxonomyType:"category"}),isShownByDefault:!0,children:(0,i.jsx)(l.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,c.__)("Choose Taxonomy","spectra-pro"),value:g,options:T,onChange:e=>t({taxonomyType:e}),help:(0,c.__)("Select the taxonomy type for filtering.","spectra-pro")})}),["category","post_tag"].includes(g)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.__experimentalToolsPanelItem,{hasValue:()=>!!h,label:(0,c.__)("Taxonomy Settings","spectra-pro"),onDeselect:()=>t({filterMode:"include"}),isShownByDefault:!0,children:(0,i.jsxs)(l.__experimentalToggleGroupControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,c.__)("Filter Mode","spectra-pro"),value:h,onChange:e=>t({filterMode:e}),help:(0,c.__)("Choose whether to include or exclude the selected taxonomy.","spectra-pro"),isBlock:!0,children:[(0,i.jsx)(l.__experimentalToggleGroupControlOption,{value:"include",label:(0,c._x)("Include","Taxonomy filter option","spectra-pro")}),(0,i.jsx)(l.__experimentalToggleGroupControlOption,{value:"exclude",label:(0,c._x)("Exclude","Taxonomy filter option","spectra-pro")})]})}),"include"===h&&(0,i.jsxs)(i.Fragment,{children:["category"===g&&(0,i.jsx)(l.__experimentalToolsPanelItem,{hasValue:()=>!!y,label:(0,c.__)("Include Taxonomy","spectra-pro"),onDeselect:()=>t({catTaxonomyInclude:[]}),isShownByDefault:!0,children:(0,i.jsx)(l.FormTokenField,{label:(0,c.__)("Include Taxonomy","spectra-pro"),value:B(y),suggestions:f,onChange:e=>t({catTaxonomyInclude:e.map((e=>{const t=v.find((t=>t.label===e));return t?t.value:e}))}),__experimentalShowHowTo:!1,__experimentalExpandOnFocus:!0,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})}),"post_tag"===g&&(0,i.jsx)(l.__experimentalToolsPanelItem,{hasValue:()=>!!C,label:(0,c.__)("Include Taxonomy","spectra-pro"),onDeselect:()=>t({tagTaxonomyInclude:[]}),isShownByDefault:!0,children:(0,i.jsx)(l.FormTokenField,{label:(0,c.__)("Include Taxonomy","spectra-pro"),value:B(C),suggestions:E,onChange:e=>t({tagTaxonomyInclude:e.map((e=>{const t=v.find((t=>t.label===e));return t?t.value:e}))}),__experimentalShowHowTo:!1,__experimentalExpandOnFocus:!0,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})})]}),"exclude"===h&&(0,i.jsxs)(i.Fragment,{children:["category"===g&&(0,i.jsx)(l.__experimentalToolsPanelItem,{hasValue:()=>!!w,label:(0,c.__)("Include Taxonomy","spectra-pro"),onDeselect:()=>t({catTaxonomyExclude:[]}),isShownByDefault:!0,children:(0,i.jsx)(l.FormTokenField,{label:(0,c.__)("Exclude Taxonomy","spectra-pro"),value:B(w),suggestions:M,onChange:e=>t({catTaxonomyExclude:e.map((e=>{const t=v.find((t=>t.label===e));return t?t.value:e}))}),__experimentalShowHowTo:!1,__experimentalExpandOnFocus:!0,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})}),"post_tag"===g&&(0,i.jsx)(l.__experimentalToolsPanelItem,{hasValue:()=>!!b,label:(0,c.__)("Exclude Taxonomy","spectra-pro"),onDeselect:()=>t({tagTaxonomyExclude:[]}),isShownByDefault:!0,children:(0,i.jsx)(l.FormTokenField,{label:(0,c.__)("Exclude Taxonomy","spectra-pro"),value:B(b),suggestions:k,onChange:e=>t({tagTaxonomyExclude:e.map((e=>{const t=v.find((t=>t.label===e));return t?t.value:e}))}),__experimentalShowHowTo:!1,__experimentalExpandOnFocus:!0,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})})]})]})]})})})),x=(0,n.memo)((e=>(0,i.jsx)(m,{...e}))),_=[(0,c.__)("Categories","spectra-pro"),(0,c.__)("Uncategorized","spectra-pro")],d=(0,n.memo)((e=>{const{blocks:t,text:l}=e,[r,s]=(0,n.useState)(!1),c=(t[0]||{}).attributes||{},p=c.textColorHover||void 0,u=c.backgroundColorHover||void 0,m=c.backgroundGradientHover||void 0,x={"--spectra-text-color-hover":p,"--spectra-background-color-hover":u,"--spectra-background-gradient-hover":m},_=["filter-button-preview-wrapper",r&&p&&"spectra-text-color-hover",r&&u&&"spectra-background-color-hover",r&&m&&"spectra-background-gradient-hover"].filter(Boolean).join(" "),d=t.map(((e,t)=>0===t?{...e,attributes:{...e.attributes,text:l,className:"filter-button-preview",textColorActive:void 0,backgroundColorActive:void 0}}:e)),{selectBlock:h}=(0,a.useDispatch)(o.store),g=()=>h(t[0]?.clientId),C={...(0,o.__experimentalUseBlockPreview)({blocks:d}),className:_,style:x,onClick:g,onKeyPress:g,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1)};return(0,i.jsx)("div",{...C})})),h=(0,n.memo)((e=>{const{clientId:t,attributes:{filterType:l}}=e,r=(0,o.useBlockProps)(),n=(0,a.useSelect)((e=>{const{getBlocks:l}=e(o.store);return l(t).filter((e=>"spectra-pro/loop-builder-child-filter-button"===e.name))}),[t,l]),s=(0,o.useInnerBlocksProps)(r,{allowedBlocks:["spectra-pro/loop-builder-child-filter-button"],template:[["spectra-pro/loop-builder-child-filter-select"],["spectra-pro/loop-builder-child-filter-checkbox"],["spectra-pro/loop-builder-child-filter-button",{text:(0,c.__)("All","spectra-pro"),className:"editor-active"}]],templateLock:"all"});return(0,i.jsxs)("div",{...s,children:[s.children,"button"===l&&n.length&&_.map(((e,t)=>(0,i.jsx)(d,{blocks:n,text:e},t)))]})})),g=e=>{const{blockName:t,childPath:o="",pluginName:l="spectra"}=e;if(!["spectra","spectra-pro"].includes(l)||"spectra"===l&&!window?.uagb_blocks_info?.uagb_url||"spectra-pro"===l&&!window?.spectra_pro_blocks_info?.spectra_pro_url)return null;if(!t)return null;let a="";switch(l){case"spectra":a=`${window.uagb_blocks_info.uagb_url}/spectra-v3`;break;case"spectra-pro":a=`${window.spectra_pro_blocks_info.spectra_pro_url}/spectra-pro-v2`}const r=`${a}/assets/block-previews/${o?o+"/":""}${t}.webp`;return(0,i.jsx)("img",{width:"100%",src:r,alt:""})},C=e=>({width:24,height:24,fill:"none",className:e&&"spectra-block-icon--colored"}),b={fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},y={filter:(e=!0)=>(0,n.createElement)("svg",{viewBox:"0 0 24 25",...C(e)},(0,n.createElement)("path",{d:"M9.99988 20.1681C9.9998 20.3539 10.0515 20.5361 10.1492 20.6942C10.2469 20.8523 10.3867 20.98 10.5529 21.0631L12.5529 22.0631C12.7054 22.1393 12.8748 22.1752 13.0451 22.1675C13.2154 22.1598 13.3809 22.1087 13.5259 22.019C13.6709 21.9293 13.7905 21.8041 13.8735 21.6552C13.9565 21.5062 14 21.3386 13.9999 21.1681V14.1681C14.0001 13.6725 14.1843 13.1946 14.5169 12.8271L21.7399 4.83809C21.8693 4.69465 21.9545 4.51677 21.985 4.32597C22.0155 4.13517 21.9901 3.93962 21.9118 3.76297C21.8335 3.58631 21.7057 3.43611 21.5439 3.33054C21.3821 3.22497 21.1931 3.16855 20.9999 3.16809H2.99988C2.80649 3.16816 2.61727 3.22431 2.45513 3.32973C2.293 3.43515 2.16491 3.58532 2.08639 3.76205C2.00786 3.93879 1.98227 4.1345 2.01271 4.32548C2.04315 4.51646 2.12831 4.69452 2.25788 4.83809L9.48288 12.8271C9.81542 13.1946 9.99966 13.6725 9.99988 14.1681V20.1681Z",...b})),filterButton:(e=!0)=>(0,n.createElement)("svg",{viewBox:"0 0 24 24",...C(e)},(0,n.createElement)("path",{d:"M20 6H4C2.89543 6 2 6.89543 2 8V16C2 17.1046 2.89543 18 4 18H20C21.1046 18 22 17.1046 22 16V8C22 6.89543 21.1046 6 20 6Z",...b}),(0,n.createElement)("path",{d:"M6 11.9678L17.9998 12.0316",...b})),filterCheckbox:(e=!0)=>(0,n.createElement)("svg",{viewBox:"0 0 24 24",...C(e)},(0,n.createElement)("path",{d:"M9 12L11 14L15 10M5 3H19C20.1046 3 21 3.89543 21 5V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V5C3 3.89543 3.89543 3 5 3Z",...b})),filterSelect:(e=!0)=>(0,n.createElement)("svg",{viewBox:"0 0 24 24",...C(e)},(0,n.createElement)("path",{d:"M20 6H4C2.89543 6 2 6.89543 2 8V16C2 17.1046 2.89543 18 4 18H20C21.1046 18 22 17.1046 22 16V8C22 6.89543 21.1046 6 20 6Z",...b}),(0,n.createElement)("path",{d:"M11.75 10.4375L14.875 13.5625L18 10.4375",...b})),noResults:(e=!0)=>(0,n.createElement)("svg",{viewBox:"0 0 24 24",...C(e)},(0,n.createElement)("path",{d:"M13.5 8.5L8.5 13.5M8.5 8.5L13.5 13.5M21 21L16.7 16.7M19 11C19 15.4183 15.4183 19 11 19C6.58172 19 3 15.4183 3 11C3 6.58172 6.58172 3 11 3C15.4183 3 19 6.58172 19 11Z",...b})),pagination:(e=!0)=>(0,n.createElement)("svg",{viewBox:"0 0 24 25",...C(e)},(0,n.createElement)("path",{d:"M5.7875 8.56812L2.1875 12.1681L5.7875 15.7681",...b}),(0,n.createElement)("path",{d:"M11.9949 12.1681H12.0049M16.9949 12.1681H17.0049M6.99487 12.1681H7.00487",...b}),(0,n.createElement)("path",{d:"M18.2124 15.7681L21.8124 12.1681L18.2124 8.56812",...b})),paginationNext:(e=!0)=>(0,n.createElement)("svg",{viewBox:"0 0 24 25",...C(e)},(0,n.createElement)("path",{d:"M8 12.1681H16M16 12.1681L12 16.1681M16 12.1681L12 8.16809M5 3.16809H19C20.1046 3.16809 21 4.06352 21 5.16809V19.1681C21 20.2727 20.1046 21.1681 19 21.1681H5C3.89543 21.1681 3 20.2727 3 19.1681V5.16809C3 4.06352 3.89543 3.16809 5 3.16809Z",...b})),paginationNumbers:(e=!0)=>(0,n.createElement)("svg",{viewBox:"0 0 24 25",...C(e)},(0,n.createElement)("path",{d:"M1.604 9.79688L4.90869 7.59375V16.4062M11.4458 16.4062H11.4524M14.75 16.4062H14.7566M8.1416 16.4062H8.14821M17.9897 14.2031C17.9897 15.4199 18.9761 16.4062 20.1929 16.4062C21.4096 16.4062 22.396 15.4199 22.396 14.2031C22.396 12.9864 21.4096 12 20.1929 12C18.9761 12 17.9897 12.9864 17.9897 14.2031ZM17.9897 14.2031C17.9897 11.4492 19.0913 9.79688 21.2944 7.59375",...b})),paginationPrevious:(e=!0)=>(0,n.createElement)("svg",{viewBox:"0 0 24 25",...C(e)},(0,n.createElement)("path",{d:"M12 8.16809L8 12.1681M8 12.1681L12 16.1681M8 12.1681H16M5 3.16809H19C20.1046 3.16809 21 4.06352 21 5.16809V19.1681C21 20.2727 20.1046 21.1681 19 21.1681H5C3.89543 21.1681 3 20.2727 3 19.1681V5.16809C3 4.06352 3.89543 3.16809 5 3.16809Z",...b})),reset:(e=!0)=>(0,n.createElement)("svg",{viewBox:"0 0 24 25",...C(e)},(0,n.createElement)("path",{d:"M3 12.1681C3 13.9481 3.52784 15.6882 4.51677 17.1682C5.50571 18.6483 6.91131 19.8018 8.55585 20.483C10.2004 21.1642 12.01 21.3424 13.7558 20.9952C15.5016 20.6479 17.1053 19.7907 18.364 18.5321C19.6226 17.2734 20.4798 15.6697 20.8271 13.9239C21.1743 12.1781 20.9961 10.3685 20.3149 8.72394C19.6337 7.0794 18.4802 5.6738 17.0001 4.68486C15.5201 3.69593 13.78 3.16809 12 3.16809C9.48395 3.17756 7.06897 4.15931 5.26 5.90809L3 8.16809M3 8.16809V3.16809M3 8.16809H8",...b})),search:(e=!0)=>(0,n.createElement)("svg",{viewBox:"0 0 24 25",...C(e)},(0,n.createElement)("path",{d:"M21 21.1681L16.7 16.8681M19 11.1681C19 15.5864 15.4183 19.1681 11 19.1681C6.58172 19.1681 3 15.5864 3 11.1681C3 6.74981 6.58172 3.16809 11 3.16809C15.4183 3.16809 19 6.74981 19 11.1681Z",...b})),sort:(e=!0)=>(0,n.createElement)("svg",{viewBox:"0 0 24 25",...C(e)},(0,n.createElement)("path",{d:"M3 16.1681L7 20.1681M7 20.1681L11 16.1681M7 20.1681V4.16809M11 4.16809H21M11 8.16809H18M11 12.1681H15",...b})),template:(e=!0)=>(0,n.createElement)("svg",{viewBox:"0 0 24 24",...C(e)},(0,n.createElement)("path",{d:"M4 16C2.9 16 2 15.1 2 14V4C2 2.9 2.9 2 4 2H14C15.1 2 16 2.9 16 4M10 8H20C21.1046 8 22 8.89543 22 10V20C22 21.1046 21.1046 22 20 22H10C8.89543 22 8 21.1046 8 20V10C8 8.89543 8.89543 8 10 8Z",...b}))};(0,e.registerBlockType)(t.UU,{icon:y.filter(),edit:e=>{const{isSelected:t,attributes:{isPreview:o}}=e;return o?(0,i.jsx)(g,{childPath:"loop-builder-children",blockName:"filter",pluginName:"spectra-pro"}):(0,i.jsxs)(i.Fragment,{children:[t&&(0,i.jsx)(x,{...e}),(0,i.jsx)(h,{...e})]})},save:()=>(0,i.jsx)(o.InnerBlocks.Content,{})})})();